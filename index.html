<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<title>WebApiContrib.Formatting.Xlsx</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,400,300,600">
<link rel="stylesheet" href="css/site.css">
<link rel="stylesheet" href="css/prism.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--[if lt IE 10]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<header>
	<h1>WebApiContrib&#8203;.Formatting&#8203;<span class="xlsx">.Xlsx</span></h1>
	<p>Make smart, beautiful Excel documents with ASP.NET Web API.</p>
	<ul>
		<li><a class="zip" href="https://github.com/WebApiContrib/WebApiContrib.Formatting.Xlsx/archive/master.zip">Download <strong>ZIP File</strong></a>
		<li><a class="github" href="https://github.com/WebApiContrib/WebApiContrib.Formatting.Xlsx">View on <strong>GitHub</strong></a>
	</ul>
</header>

<main>
	<p class="intro">Generate <strong>formatted, customisable</strong> Excel documents straight from ASP.NET Web API.</p>

	<nav id="toc">
		<h2>Contents</h2>
		<ul>
			<li><a href="#features">Features</a>
			<li><a href="#limitations">Limitations</a>
			<li><a href="#setting-it-up">Setting it up</a>
				<ul>
					<li><a href="#advanced-setup-options">Advanced setup options</a>
					<li><a href="#advanced-setup-example">Advanced setup example</a>
				</ul>
			<li><a href="#set-generated-file">Set generated file name with <code>Excel&shy;Document&shy;Attribute</code></a>
			<li><a href="#controlling-serialisation-output">Controlling serialisation output with <code>Excel&shy;Column&shy;Attribute</code></a>
				<ul>
					<li><a href="#set-column-header">Set column header names</a>
					<li><a href="#set-number-format">Set number format for data cells</a>
					<li><a href="#ignore-a-column">Ignore a column</a>
					<li><a href="#customise-display-order">Customise display order</a>
					<li><a href="#change-boolean-property">Change boolean property output</a>
					<li><a href="#use-displayformat-attribute">Use <code>DisplayFormat</code> attribute</a>
				</ul>
			<li><a href="#future-work">Future work</a>
		</ul>
	</nav>

	<h2 id="features">Features</h2>
	<ul>
		<li>Control over column names, order, number format and visibility of properties in generated Excel documents via custom attribute.
		<li>Lots of formatting options:
			<ul>
				<li>freeze header rows;
				<li>add auto-filter;
				<li>customize header row and cell styles; and
				<li>autofit column widths to data.
			</ul>
		<li>Decent (and improving) unit test coverage.
	</ul>

	<h2 id="limitations">Limitations</h2>
	<p><code>Xlsx&shy;Media&shy;Type&shy;Formatter</code> does not do deep serialisation of complex (i.e. nested) types, nor does it yet deserialise data from Excel. Both of these are major priorities; see the <a href="https://github.com/jordangray/xlsx-for-web-api/issues/milestones">project milestones</a> for a rough schedule.

	<h2 id="setting-it-up">Setting it up</h2>
	<ol>
		<li>Add a reference to <kbd>EPPlus.dll</kbd> to your projectâ€”you can either <a href="http://epplus.codeplex.com/">download it from CodePlex</a> or <a href="http://www.nuget.org/packages/EPPlus/">grab the package on NuGet</a>.
		<li>Add a reference to <kbd>WebApiContrib&#8203;.Formatting&#8203;.Xlsx&#8203;.dll</kbd> to your project.
		<li>Add the <code>Xlsx&shy;Media&shy;Type&shy;Formatter</code> to the formatter collection in your Web API configuration. This will look something like:
			<pre><code class="language-csharp">config.Formatters.Add(new XlsxMediaTypeFormatter()); // Where config = System.Web.Http.HttpConfiguration.</code></pre>
	</ol>
	<p>You are now good to go forth and serialise; however, you may find the generated Excel output a tad boring. Enter the advanced formatter instantiation options!

	<h3 id="advanced-setup-options">Advanced setup options</h3>
	<p>The <code>Xlsx&shy;Media&shy;Type&shy;Formatter</code> provides a number of options for customising the appearance of generated Excel files.
	<dl>
		<dt><code>autoFit</code>
		<dd><strong>Default <code>true</code>.</strong>
		<dd>Fit columns to the maximum width of the data they contain.

		<dt><code>autoFilter</code>
		<dd><strong>Default <code>false</code>.</strong>
		<dd>Set the column headers up as an auto-filter on the data.

		<dt><code>freezeHeader</code>
		<dd><strong>Default <code>false</code>.</strong>
		<dd>Split the top row of cells so that the column headers stay at the top of the window while scrolling through data.

		<dt><code>headerHeight</code>
		<dd><strong>Default <code>0</code> (not set).</strong>
		<dd>Set the height of the column header row.

		<dt><code>cellStyle</code>
		<dd><strong>Default <code>null</code>.</strong>
		<dd>Can take an <code>Action&#8203;&lt;Office&shy;Open&shy;Xml&#8203;.Style&#8203;.Excel&shy;Style&gt;</code> that specifies visual formatting options (such as fonts and borders) for all cells.

		<dt><code>headerStyle</code>
		<dd><strong>Default <code>null</code>.</strong>
		<dd>Can take an <code>Action&#8203;&lt;Office&shy;Open&shy;Xml&#8203;.Style&#8203;.Excel&shy;Style&gt;</code> that specifies visual formatting options (such as fonts and borders) for only the column header cells.
	</dl>

	<h4 id="advanced-setup-example">Advanced setup example</h4>
	<pre><code class="language-csharp">var formatter = new XlsxMediaTypeFormatter(
    autoFilter: true,
    freezeHeader: true,
    headerHeight: 25f,
    cellStyle: (ExcelStyle s) => {
        s.Font.SetFromFont(new Font("Segoe UI", 13f, FontStyle.Regular));
    },
    headerStyle: (ExcelStyle s) => {
        s.Fill.PatternType = ExcelFillStyle.Solid;
        s.Fill.BackgroundColor.SetColor(Color.FromArgb(0, 114, 51));
        s.Font.Color.SetColor(Color.White);
        s.Font.Size = 15f;
    }
);

config.Formatters.Add(formatter);</code></pre>

	<h2 id="set-generated-file">Set the generated file name with <code>Excel&shy;Document&shy;Attribute</code></h2>
	<p>With the <code>Excel&shy;Document&shy;Attribute</code>, you can set the file name used for an Excel document generated from a type.</p>
	<pre><code class="language-csharp">[ExcelDocument("Column header")]
public class ItemType { // ...</code></pre>

	<h2 id="controlling-serialisation-output">Controlling serialisation output with <code>Excel&shy;Column&shy;Attribute</code></h2>
	<p>You can control how data gets serialised into columns using <code>Excel&shy;Column&shy;Attribute</code> on individual properties.</p>

	<h3 id="set-column-header">Set column header names</h3>
	<p>Header names can be provided using the <code>Header</code> parameter.</p>
	<pre><code class="language-csharp">[ExcelColumn(Header = "Column header")]
public string Value { get; set; }</code></pre>

	<h3 id="set-number-format">Set number format for data cells</h3>
	<p>The <code>Number&shy;Format</code> parameter allows you to provide a <a href="http://office.microsoft.com/en-001/excel-help/create-a-custom-number-format-HP010342372.aspx">custom Excel number format</a> to alter the number format used for data in a given column. For example, the following snippet will align numbers on the decimal point:</p>
	<pre><code class="language-csharp">[ExcelColumn(NumberFormat = "???.???")]
public decimal Value { get; set; }</code></pre>

	<h3 id="ignore-a-column">Ignore a column</h3>
	<p>To prevent a property from appearing as a column in the generated Excel file, set the <code>Ignore</code> parameter to true.</p>
	<pre><code class="language-csharp">[ExcelColumn(Ignore = true)]
public string Value { get; set; }</code></pre>

	<h3 id="customise-display-order">Customise display order</h3>
	<p>By default, columns are ordered according to property order in the source, with properties in derived classes coming before those in base classes. However, sometimes you need more control over the order in which columns appear.</p>
	<p>The <code>Order</code> parameter works similarly to <a href="http://james.newtonking.com/json/help/index.html?topic=html/JsonPropertyOrder.htm">JSON.NET's <code>Json&shy;Property&shy;Attribute&#8203;.Order</code></a>, on which implementation it was partially based. Properties are serialised from lowest to highest <code>Order</code> parameter value, and properties with the same <code>Order</code> value are in source order. By default, all properties are assumed to have an <code>Order</code> value of -1.</p>
	<p>Confusing? Here's an example showing all of these rules at work:</p>
	<pre><code class="language-csharp">// Second, because it has an implicit Order of -1 and is the
// first item with that Order value.
public string Value1 { get; set; }

// Last, because it has the highest Order value.
[ExcelColumn(Order = 2)]
public string Value2 { get; set; }

// Second-to-last, because it has the second-highest Order value.
[ExcelColumn(Order = 1)]
public string Value3 { get; set; }

// First, because it has the lowest Order value.
[ExcelColumn(Order = -2)]
public string Value4 { get; set; }

// Third, because it has an implicit Order of -1 and is the
// second item with that Order value.
public string Value5 { get; set; }</code></pre>

	<h3 id="change-boolean-property">Change boolean property output</h3>
	<p>By default, boolean properties are serialised to either <samp>True</samp> or <samp>False</samp>. You can customise this behaviour on individual columns so that different values are output.</p>
	<pre><code class="language-csharp">// Use "Yes" and "No" to represent the value of this property.
[ExcelColumn(TrueValue = "Yes", FalseValue="No")]
public bool Value { get; set; }</code></pre>

	<h3 id="use-displayformat-attribute">Use <code>DisplayFormat</code> attribute</h3>
	<p>This will apply any format string set on the property via the <code>DisplayFormat</code> (or <code>DisplayFormat</code>) attribute to this property&rsquo;s value, saving the value as a formatted string in the generated Excel document. (By default, it will be ignored.)</p>
	<pre><code class="language-csharp">[DisplayFormat(DataFormatString = "{0:D}")]
[ExcelColumn(UseDisplayFormatString = true)]
public DateTime Value { get; set; }</code></pre>

	<h2 id="future-work">Future work</h2>
	<ul>
		<li>Allow serialisation of complex/nested types.
		<li>Allow reading from Excel documents.
		<li>Provide much, much finer control over serialisation of individual classes and properties.
	</ul>
	<p>For more details on planned work and the current project schedule, refer to the <a href="https://github.com/jordangray/xlsx-for-web-api/issues/milestones">project milestones</a>.
	<p>Have an idea that you don't see here? Can't figure out how to do something? Would like to use this, but it doesn't cover your needs? Go ahead and <a href="https://github.com/jordangray/xlsx-for-web-api/issues/new">open an issue</a>!</p>
</main>

<footer>
	<h2>Credits and disclaimers</h2>
	<p><strong>WebApiContrib&#8203;.Formatting&#8203;<span class="xlsx">.Xlsx</span></strong> is maintained by <a href="https://github.com/jordangray">Jordan Gray</a> (<a href="https://twitter.com/jordangray">@jordangray</a>) as part of the <a href="https://github.com/WebApiContrib">WebApiContrib project</a>. The ZIP and GitHub icons are from the <a href="http://modernuiicons.com/">Modern UI Icons</a> collection by <a href="http://templarian.com/">Austin Andrew</a> (<a href="https://twitter.com/Templarian">@templarian</a>).</p>
	<p>Microsoft and Excel are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries. This project is not endorsed by Microsoft Corporation.</p>
</footer>

<!-- Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-47247606-1', 'jordangray.github.io');
ga('send', 'pageview');
</script>

<!-- Table of contents -->
<script>
	var toc = document.getElementById('toc'),
		header = toc.getElementsByTagName('h2')[0],
		ul = toc.getElementsByTagName('ul')[0],
		toggle = document.createElement('span');

	toggle.className = 'toggle-toc';	
	toggle.innerHTML = ' (<a>close</a>)';

	header.appendChild(toggle);

	function toggleContents() {
		var current = toc.className || 'open';
		if (current == 'open') {
			toc.className = 'closed';
			toggle.innerHTML = ' (<a>open</a>)';
			ul.style.display = 'none';
		} else {
			toc.className = "open";
			toggle.innerHTML = ' (<a>close</a>)';
			ul.style.display = 'block';
		}
	}

	toggle.addEventListener('click', toggleContents);
	toggleContents();
</script>

<script src="prism/prism.js"></script>
<script src="prism/prism.csharp.js"></script>
